define("@cxl/dom",["require","exports","@cxl/rx"],(function(e,t,n){"use strict";function r(e){let t;for(;t=e.childNodes[0];)e.removeChild(t)}function i(e,t,r){return new n.Observable((n=>{const i=n.next.bind(n);return e.addEventListener(t,i,r),e.removeEventListener.bind(e,t,i,r)}))}function o(e,t){return i(e,"keydown").filter((e=>!t||e.key.toLowerCase()===t))}function s(){return(0,n.defer)((()=>"complete"===document.readyState?(0,n.of)(!0):i(window,"load").first().map((()=>!0))))}Object.defineProperty(t,"__esModule",{value:!0}),t.isHidden=t.onVisible=t.onIntersection=t.onMutation=t.fileReaderString=t.insert=t.onResize=t.findNextNodeBySelector=t.findNextNode=t.animationFrame=t.onLocation=t.onHistoryChange=t.onHashChange=t.ChildrenObserver=t.onAttributeChange=t.onChildrenMutation=t.observeChildren=t.AttributeObserver=t.trigger=t.setAttribute=t.getShadow=t.onFontsReady=t.onLoad=t.onReady=t.onAction=t.onKeypress=t.on=t.setContent=t.empty=void 0,t.empty=r,t.setContent=function(e,t){r(e),v(e,t)},t.on=i,t.onKeypress=o,t.onAction=function(e){return(0,n.merge)(i(e,"click"),o(e,"enter"))},t.onReady=function(){return(0,n.defer)((()=>"loading"!==document.readyState?(0,n.of)(!0):i(window,"DOMContentLoaded").first().map((()=>!0))))},t.onLoad=s,t.onFontsReady=function(){return(0,n.from)(document.fonts.ready)};const a={mode:"open"};t.getShadow=function(e){return e.shadowRoot||e.attachShadow(a)},t.setAttribute=function(e,t,n){return null===(n=!1===n||null==n?null:!0===n?"":n.toString())?e.removeAttribute(t):e.setAttribute(t,n),n},t.trigger=function(e,t,n){const r=new CustomEvent(t,{detail:n,bubbles:!0});e.dispatchEvent(r)};class c extends n.Subject{constructor(e){if(super(),this.element=e,e.$$attributeObserver)return e.$$attributeObserver;this.element=e,e.$$attributeObserver=this}$onMutation(e){e.forEach((e=>e.attributeName&&this.trigger(e.attributeName)))}$onEvent(){const e=this.element;e.value!==this.$value&&(this.$value=e.value,this.trigger("value")),e.checked!==this.$checked&&(this.$checked=e.checked,this.trigger("checked"))}$initializeNative(e){this.observer=new MutationObserver(this.$onMutation.bind(this)),this.observer.observe(e,{attributes:!0}),this.bindings=[i(e,"change").subscribe(this.$onEvent.bind(this))]}onSubscribe(e){const t=this.element;t.$view||this.observer||this.$initializeNative(t);const n=super.onSubscribe(e);return()=>{n(),0===this.observers.size&&this.disconnect()}}disconnect(){var e;this.observer&&(this.observer.disconnect(),this.observer=void 0,null===(e=this.bindings)||void 0===e||e.forEach((e=>e.unsubscribe())))}trigger(e){this.next({type:"attribute",target:this.element,value:e})}}function u(e){return new d(e)}t.AttributeObserver=c,t.observeChildren=function(e){let t;return(0,n.merge)((0,n.defer)((()=>(t=e.childNodes,t?(0,n.of)(t):n.EMPTY))),u(e),s().switchMap((()=>e.childNodes!==t?(t=e.childNodes,(0,n.of)(t)):n.EMPTY)))},t.onChildrenMutation=u,t.onAttributeChange=function(e){return new c(e)};class d extends n.Subject{constructor(e){if(super(),this.element=e,e.$$childrenObserver)return e.$$childrenObserver;this.element=e,e.$$childrenObserver=this}$handleEvent(e){const t=this.element;for(const n of e.addedNodes)this.next({type:"added",target:t,value:n});for(const n of e.removedNodes)this.next({type:"removed",target:t,value:n})}onSubscribe(e){const t=this.element;this.observer||(this.observer=new MutationObserver((e=>e.forEach(this.$handleEvent,this))),this.observer.observe(t,{childList:!0}));const n=super.onSubscribe(e);return()=>{n(),0===this.observers.size&&this.observer&&(this.observer.disconnect(),this.observer=void 0)}}}function h(){return(0,n.concat)((0,n.of)(location.hash.slice(1)),i(window,"hashchange").map((()=>location.hash.slice(1))))}let l;function b(){if(!l){l=(0,n.be)(history.state);const e=history.pushState;history.pushState=function(...t){const n=e.apply(this,t);return history.state&&(history.state.lastAction="push"),l.next(history.state),n}}return(0,n.merge)(i(window,"popstate").map((()=>(history.state&&(history.state.lastAction="pop"),history.state))),l)}function v(e,t){void 0!==t&&(t instanceof Node||(t=document.createTextNode(t)),e.appendChild(t))}function f(e){return new n.Observable((t=>{const n=new IntersectionObserver((e=>{for(const n of e)t.next(n)}));return n.observe(e),()=>n.disconnect()}))}t.ChildrenObserver=d,t.onHashChange=h,t.onHistoryChange=b,t.onLocation=function(){let e;return(0,n.merge)(h(),b()).map((()=>window.location)).filter((t=>{const n=t.href!==e;return e=t.href,n}))},t.animationFrame=new n.Observable((e=>{let t=0,n=requestAnimationFrame((function r(){if(e.closed)return;e.next(t++),n=requestAnimationFrame(r)}));return()=>cancelAnimationFrame(n)})),t.findNextNode=function(e,t,n="nextSibling"){let r=e[n];for(;r;){if(t(r))return r;r=r[n]}},t.findNextNodeBySelector=function(e,t,n="nextElementSibling"){let r=e[n];for(;r;){if(r.matches(t))return r;r=r[n]}return null},t.onResize=function(e){return new n.Observable((t=>{const n=new ResizeObserver((e=>t.next(e)));return n.observe(e),()=>n.unobserve(e)}))},t.insert=v,t.fileReaderString=function(e){return new n.Observable((t=>{const n=new FileReader;n.readAsBinaryString(e),n.addEventListener("load",(()=>{t.next(n.result),t.complete()}))}))},t.onMutation=function(e,t={attributes:!0,childList:!0}){return new n.Observable((n=>{const r=new MutationObserver((t=>t.forEach((t=>{for(const r of t.addedNodes)n.next({type:"added",target:e,value:r});for(const r of t.removedNodes)n.next({type:"removed",target:e,value:r});t.attributeName&&n.next({type:"attribute",target:e,value:t.attributeName})}))));return r.observe(e,t),()=>r.disconnect()}))},t.onIntersection=f,t.onVisible=function(e){return f(e).map((e=>e.isIntersecting))},t.isHidden=function(e){return null===e.offsetParent}}));
//# sourceMappingURL=index.min.js.map