define("@cxl/router",["require","exports"],(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Router=e.Strategies=e.HashStrategy=e.PathStrategy=e.QueryStrategy=e.parseUrl=e.getElementRoute=e.RouteManager=e.Route=e.parseQueryParameters=e.replaceParameters=e.normalize=e.sys=void 0;const r=/([^&=]+)=?([^&]*)/g,s=/:([\w_$@]+)/g,i=/\/\((.*?)\)/g,o=/(\(\?)?:\w+/g,n=/\*\w+/g,a=/[-{}[\]+?.,\\^$|#\s]/g,h="@@cxlRoute";function u(t){return"/"===t[0]&&(t=t.slice(1)),t.endsWith("/")&&(t=t.slice(0,-1)),t}function c(t,e){return e?t.replace(s,((t,r)=>e[r]||"")):t}function l(t){const e={};let s;for(;s=r.exec(t);)e[s[1]]=decodeURIComponent(s[2]);return e}e.sys={location:window.location,history:window.history},e.normalize=u,e.replaceParameters=c,e.parseQueryParameters=l;class d{constructor(t){this.path=t=u(t),[this.regex,this.parameters]=function(t){const e=[];return[new RegExp("^/?"+t.replace(a,"\\$&").replace(i,"\\/?(?:$1)?").replace(o,(function(t,r){return e.push(t.substr(1)),r?t:"([^/?]*)"})).replace(n,"([^?]*?)")+"(?:/$|\\?|$)"),e]}(t)}_extractQuery(t){const e=t.indexOf("?");return-1===e?{}:l(t.slice(e+1))}getArguments(t){const e=this.regex.exec(t),r=e&&e.slice(1);if(!r)return;const s=this._extractQuery(t);return r.forEach(((t,e)=>{const i=e===r.length-1?t||"":t?decodeURIComponent(t):"";s[this.parameters[e]]=i})),s}test(t){return this.regex.test(t)}toString(){return this.path}}class p{constructor(t){var e;if(void 0!==t.path)this.path=new d(t.path);else if(!t.id)throw new Error("An id or path is required.");this.id=t.id||(null!==(e=t.path)&&void 0!==e?e:`route${Math.random().toString()}`),this.isDefault=t.isDefault||!1,this.parent=t.parent,this.redirectTo=t.redirectTo,this.definition=t}createElement(t){const e=this.definition.render();e[h]=this;for(const r in t)e[r]=t[r];return e}create(t){const e=this.definition.resolve;return e&&!1===e(t)?null:this.createElement(t)}}e.Route=p;class f{constructor(){this.routes=[]}findRoute(t){return this.routes.find((e=>{var r;return null===(r=e.path)||void 0===r?void 0:r.test(t)}))||this.defaultRoute}get(t){return this.routes.find((e=>e.id===t))}register(t){if(t.isDefault){if(this.defaultRoute)throw new Error("Default route already defined");this.defaultRoute=t}this.routes.unshift(t)}}e.RouteManager=f;const g=/([^#]*)(?:#(.+))?/;function y(t){const e=g.exec(t);return{path:u((null==e?void 0:e[1])||""),hash:(null==e?void 0:e[2])||""}}e.getElementRoute=function(t){return t[h]},e.parseUrl=y,e.QueryStrategy={getHref:t=>(t="string"==typeof t?y(t):t,`${e.sys.location.pathname}${t.path?`?${t.path}`:""}${t.hash?`#${t.hash}`:""}`),serialize(t){var r;const s=null===(r=e.sys.history.state)||void 0===r?void 0:r.url;s&&t.hash===s.hash&&t.path===s.path||e.sys.history.pushState({url:t},"",this.getHref(t))},deserialize(){var t;return(null===(t=e.sys.history.state)||void 0===t?void 0:t.url)||{path:e.sys.location.search.slice(1),hash:e.sys.location.hash.slice(1)}}},e.PathStrategy={getHref:t=>`${(t="string"==typeof t?y(t):t).path}${t.hash?`#${t.hash}`:""}`,serialize(t){var r;const s=null===(r=e.sys.history.state)||void 0===r?void 0:r.url;s&&t.hash===s.hash&&t.path===s.path||e.sys.history.pushState({url:t},"",this.getHref(t))},deserialize(){var t;return(null===(t=e.sys.history.state)||void 0===t?void 0:t.url)||{path:e.sys.location.pathname,hash:e.sys.location.hash.slice(1)}}},e.HashStrategy={getHref:t=>`#${(t="string"==typeof t?y(t):t).path}${t.hash?`#${t.hash}`:""}`,serialize(t){const r=e.HashStrategy.getHref(t);e.sys.location.hash!==r&&(e.sys.location.hash=r)},deserialize:()=>y(e.sys.location.hash.slice(1))},e.Strategies={hash:e.HashStrategy,path:e.PathStrategy,query:e.QueryStrategy};e.Router=class{constructor(t){this.callbackFn=t,this.routes=new f,this.instances={}}findRoute(t,e){const r=this.instances[t];let s;if(r)for(s in e)r[s]=e[s];return r}executeRoute(t,e,r){const s=t.parent,i=s&&this.routes.get(s),o=t.id,n=i&&this.executeRoute(i,e,r),a=this.findRoute(o,e)||t.create(e);return n?a&&a.parentNode!==n&&n.appendChild(a):this.root=a,r[o]=a,a}discardOldRoutes(t){var e;const r=this.instances;for(const s in r){const i=r[s];t[s]!==i&&(null===(e=i.parentNode)||void 0===e||e.removeChild(i),delete r[s])}}execute(t,e){const r={},s=this.executeRoute(t,e||{},r);return this.discardOldRoutes(r),this.instances=r,s}route(t){const e=new p(t);return this.routes.register(e),e}go(t){var e,r;const s="string"==typeof t?y(t):t,i=s.path,o=null===(e=this.state)||void 0===e?void 0:e.url;if(o&&i===o.path&&s.hash===o.hash)return;const n=this.routes.findRoute(i);if(!n)throw new Error(`Path: "${i}" not found`);const a=null===(r=n.path)||void 0===r?void 0:r.getArguments(i);if(n.redirectTo)return this.go(c(n.redirectTo,a));const h=this.execute(n,a);if(!this.root)throw new Error(`Route: "${i}" could not be created`);this.state={url:s,arguments:a,route:n,current:h,root:this.root},this.callbackFn&&this.callbackFn(this.state)}getPath(t,e){const r=this.routes.get(t),s=r&&r.path;return s&&c(s.toString(),e)}isActiveUrl(t){var e;const r=y(t);if(!(null===(e=this.state)||void 0===e?void 0:e.url))return!1;const s=this.state.url;return!!Object.values(this.instances).find((t=>{var e,i;const o=t[h],n=null===(e=this.state)||void 0===e?void 0:e.arguments;if((null===(i=o.path)||void 0===i?void 0:i.test(r.path))&&(!r.hash||r.hash===s.hash)){if(n){const t=o.path.getArguments(r.path);for(const e in t)if(n[e]!=t[e])return!1}return!0}return!1}))}}}));
//# sourceMappingURL=index.min.js.map